<article class="post" id="post_{{ tweet.post_pk }}" mix-fade-in="5000">

    {# ---------- Avatar with fallback ---------- #}
    {% set tweet_avatar = tweet.user_avatar_path or 'avatar.jpg' %}
    <img src="{{ tweet_avatar.startswith('http') 
                and tweet_avatar 
                or url_for('static', filename='images/' + tweet_avatar) }}" alt="Profile Picture"
        class="w-8 h-8 rounded-full">

    <div class="post-content">
        <div class="post-header">
            <span class="name">{{ tweet.user_first_name }} {{ tweet.user_last_name }}</span>
            <span class="handle">@{{ tweet.user_username }}</span> Â·
            <span class="time">{{ tweet.post_time or '1d' }}</span>
        </div>

        {# ---------- Post text ---------- #}
        {% if tweet.post_message %}
        <p class="text">{{ tweet.post_message }}</p>
        {% endif %}

        {# ---------- Post image or video ---------- #}
        {% if tweet.post_image_path %}
        {% set filename = tweet.post_image_path %}
        {% set is_video = filename.endswith(('.mp4', '.webm')) %}

        {% if is_video %}
        <video controls class="w-80 rounded-md mt-2">
            <source src="{{ filename.startswith('http') 
                                and filename 
                                or url_for('static', filename='uploads/' + filename) }}" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        {% else %}
        <img src="{{ filename.startswith('http') 
                         and filename 
                         or url_for('static', filename='uploads/' + filename) }}" alt="Post media"
            class="w-80 rounded-md mt-2">
        {% endif %}
        {% endif %}

        {# ---------- Post actions ---------- #}
        <div class="post-actions">
            <span class="action"><i class="fa-regular fa-comment"></i> 12</span>
            <span class="action"><i class="fa-solid fa-retweet"></i> 5</span>
            {% include "___button_like_tweet.html" %}
            <span class="action"><i class="fa-solid fa-chart-simple"></i> 230</span>
            <span class="action"><i class="fa-solid fa-share"></i></span>

            {% if tweet.user_username == user.user_username %}
            <button onclick="editPost('{{ tweet.post_pk }}', '{{ tweet.post_message|escape }}')">Edit</button>
            <button onclick="deletePost('{{ tweet.post_pk }}')">Delete</button>
            {% endif %}
        </div>
    </div>
</article>